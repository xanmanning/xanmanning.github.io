<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.6.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-01-03T17:57:41+00:00</updated><id>http://localhost:4000/</id><title type="html">Xan Manning</title><subtitle>Ramblings of a Linux geek and cloud fanatic dabbling in DevOps!</subtitle><author><name>Xan Manning</name></author><entry><title type="html">Happy New Year, Have some Ansible Roles!</title><link href="http://localhost:4000/2020/01/03/happy-new-year-have-some-ansible-roles.html" rel="alternate" type="text/html" title="Happy New Year, Have some Ansible Roles!" /><published>2020-01-03T17:25:37+00:00</published><updated>2020-01-03T17:25:37+00:00</updated><id>http://localhost:4000/2020/01/03/happy-new-year-have-some-ansible-roles</id><content type="html" xml:base="http://localhost:4000/2020/01/03/happy-new-year-have-some-ansible-roles.html">&lt;p&gt;It’s 2020, and I have decided to release some more Ansible Roles to the public.
These roles are extracts from a “master” role I had for configuring my (home)
workstation just the way I like it. I’ve tidied them up and tried to make them
a bit more reusable, and I’m trying to support other Linux Distros than just
Ubuntu 18.04 LTS.&lt;/p&gt;

&lt;p&gt;Hopefully I will implement these on my work laptop as well.&lt;/p&gt;

&lt;p&gt;Start the New Year right, standardise your laptop build!&lt;/p&gt;

&lt;h2 id=&quot;ansible-roles&quot;&gt;Ansible Roles&lt;/h2&gt;

&lt;p&gt;The below do not require for you to become root, &lt;code class=&quot;highlighter-rouge&quot;&gt;controller&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;awscli&lt;/code&gt; and
&lt;code class=&quot;highlighter-rouge&quot;&gt;azurecli&lt;/code&gt; will install into a Python3 virtualenv:&lt;/p&gt;

&lt;h3 id=&quot;controllers&quot;&gt;Controllers&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/controller&quot;&gt;xanmanning.controller&lt;/a&gt;
- &lt;em&gt;Ansible Role to configure a system to be an Ansible Controller&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/terraform&quot;&gt;xanmanning.terraform&lt;/a&gt;
- &lt;em&gt;Ansible Role to configure system to be a Hashicorp Terraform controller&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/awscli&quot;&gt;xanmanning.awscli&lt;/a&gt;
- &lt;em&gt;Ansible Role to install AWS CLI (&lt;code class=&quot;highlighter-rouge&quot;&gt;awscli&lt;/code&gt;)&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/azurecli&quot;&gt;xanmanning.azurecli&lt;/a&gt;
- &lt;em&gt;Ansible Role to install Azure CLI (&lt;code class=&quot;highlighter-rouge&quot;&gt;azure-cli&lt;/code&gt;)&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/kubectl&quot;&gt;xanmanning.kubectl&lt;/a&gt;
- &lt;em&gt;Ansible Role to install kubectl on a system&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/helm&quot;&gt;xanmanning.helm&lt;/a&gt;
- &lt;em&gt;Ansible Role to install Helm on a system&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;development-utilities&quot;&gt;Development Utilities&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/minikube&quot;&gt;xanmanning.minikube&lt;/a&gt;
- &lt;em&gt;Ansible Role to install minikube on a system&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The below require you to become root:&lt;/p&gt;

&lt;h3 id=&quot;ides&quot;&gt;IDEs&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/atom&quot;&gt;xanmanning.atom&lt;/a&gt;
- &lt;em&gt;Ansible Role to install Atom text editor on a system&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/sublime&quot;&gt;xanmanning.sublime&lt;/a&gt;
- &lt;em&gt;Ansible Role to install Sublime text editor on a system&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/vscode&quot;&gt;xanmanning.vscode&lt;/a&gt;
- &lt;em&gt;Ansible Role to install VS Code on a system&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/vscode&quot;&gt;xanmanning.vscode&lt;/a&gt;
- &lt;em&gt;Ansible Role to install VS Code on a system&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;virtualisation&quot;&gt;Virtualisation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/virtualbox&quot;&gt;xanmanning.virtualbox&lt;/a&gt;
- &lt;em&gt;Ansible Role to install Oracle Virtualbox on a system&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/xanmanning/vagrant&quot;&gt;xanmanning.vagrant&lt;/a&gt;
- &lt;em&gt;Ansible Role to install Hashicorp Vagrant on a system&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;faqs&quot;&gt;FAQs&lt;/h2&gt;

&lt;h4 id=&quot;why-do-you-write-ansible-roles-just-for-linux&quot;&gt;“&lt;em&gt;Why do you write Ansible Roles just for Linux?!&lt;/em&gt;”&lt;/h4&gt;

&lt;p&gt;I have no need, nor desire to own or run a Windows Laptop. The same is true for
a Mac. Most of the work I do (that I am paid for) and the stuff I do in my
spare time has no requirement to use Microsoft Windows. In fact you’ll see that
most people who dabble in the technologies that I do will often use a Macintosh.&lt;/p&gt;

&lt;p&gt;Not wanting to get locked into a vendor, nor be subject to adverts in an
operating system that I purchased (&lt;strong&gt;cough&lt;/strong&gt; Microsoft), I opted for a
ThinkPad running Ubuntu Linux.&lt;/p&gt;

&lt;h4 id=&quot;why-install-everything-into-a-python-3-virtualenv&quot;&gt;“&lt;em&gt;Why install everything into a Python 3 virtualenv?!&lt;/em&gt;”&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.python.org/doc/sunset-python-2/&quot;&gt;Python 2 is dead&lt;/a&gt;, stop using it!&lt;/li&gt;
  &lt;li&gt;If you have ever used &lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt; before and installed, or upgraded a particular
tool, you’ll have noticed running into dependency hell. I’ve had it a number
of times already where I have updated azure-cli and broken something else
like Ansible. If you don’t run in a virtualenv you run the risk of breaking
stuff!&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;what-support-can-i-get-for-these-roles&quot;&gt;“&lt;em&gt;What support can I get for these roles?&lt;/em&gt;”&lt;/h4&gt;

&lt;p&gt;I will donate time to support these roles, but I cannot offer an SLA on it as
I work on these in my spare time. Between other things in life. If you have a
problem then raise an Issue on the relevant GitHub project.&lt;/p&gt;</content><author><name>Xan Manning</name></author><summary type="html">It’s 2020, and I have decided to release some more Ansible Roles to the public. These roles are extracts from a “master” role I had for configuring my (home) workstation just the way I like it. I’ve tidied them up and tried to make them a bit more reusable, and I’m trying to support other Linux Distros than just Ubuntu 18.04 LTS.</summary></entry><entry><title type="html">I did an Azure thing.</title><link href="http://localhost:4000/2019/11/20/i-did-an-azure-thing.html" rel="alternate" type="text/html" title="I did an Azure thing." /><published>2019-11-20T13:37:02+00:00</published><updated>2019-11-20T13:37:02+00:00</updated><id>http://localhost:4000/2019/11/20/i-did-an-azure-thing</id><content type="html" xml:base="http://localhost:4000/2019/11/20/i-did-an-azure-thing.html">&lt;div data-iframe-width=&quot;150&quot; data-iframe-height=&quot;270&quot; data-share-badge-id=&quot;482a4469-eab2-43f1-a987-0fe843cb68b7&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot; async=&quot;&quot; src=&quot;//cdn.youracclaim.com/assets/utilities/embed.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;Yes, I know, I’m the last person you’d think would get a Microsoft
Certification…&lt;/p&gt;</content><author><name>Xan Manning</name></author><summary type="html"></summary></entry><entry><title type="html">2019, not a good year.</title><link href="http://localhost:4000/2019/09/14/not-a-good-year.html" rel="alternate" type="text/html" title="2019, not a good year." /><published>2019-09-14T11:02:24+01:00</published><updated>2019-09-14T11:02:24+01:00</updated><id>http://localhost:4000/2019/09/14/not-a-good-year</id><content type="html" xml:base="http://localhost:4000/2019/09/14/not-a-good-year.html">&lt;p&gt;If you have stumbled upon this site from some articles I have written then tried
to find new stuff, you may have noticed that I haven’t posted a lot recently.
There are many reasons for this, but the main one is that I just don’t feel
like it.&lt;/p&gt;

&lt;p&gt;I’m not going to go into too much detail, there is a lot of private stuff going
on but it feels that all of the luck we have had this year has been bad luck.&lt;/p&gt;

&lt;p&gt;My wife and I have had a number of health issues, our families have been
subject to some serious health issues. We have lost a few beloved members.
In the middle of all of this, we’ve had a car stolen from off of our drive on
the birthday of one of our lost loved ones.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Sidenote, I will be publishing an RCA for our car theft. I’ll explain why
wireless security cameras such as smart doorbells are absolutely pointless!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Needless to say, when I get free time, I don’t really want to ‘automate’, code
nor write.&lt;/p&gt;

&lt;p&gt;Don’t despair though, I am always doing daft things with computers and the
cloud. Mostly in Azure at the minute (no, I haven’t sold out to Microsoft).&lt;/p&gt;

&lt;p&gt;Here’s a screenshot of an encrypted RAID5 with a RAID1 bcache, because why
not.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2019/09/layered-block-devices.png&quot; alt=&quot;Silly Block Device setup&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If you are having a hard year and want to feel good by donating to good causes,
here are two charities worth checking out:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.mndassociation.org/&quot;&gt;Motor Neurone Disease Association&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.cancerresearchuk.org/&quot;&gt;Cancer Research UK&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Xan Manning</name></author><summary type="html">If you have stumbled upon this site from some articles I have written then tried to find new stuff, you may have noticed that I haven’t posted a lot recently. There are many reasons for this, but the main one is that I just don’t feel like it.</summary></entry><entry><title type="html">Ansible-lint - Rule 306</title><link href="http://localhost:4000/2019/03/21/ansible-lint-rule-306.html" rel="alternate" type="text/html" title="Ansible-lint - Rule 306" /><published>2019-03-21T17:31:11+00:00</published><updated>2019-03-21T17:31:11+00:00</updated><id>http://localhost:4000/2019/03/21/ansible-lint-rule-306</id><content type="html" xml:base="http://localhost:4000/2019/03/21/ansible-lint-rule-306.html">&lt;p&gt;If you are like me you like to keep your scripting as safe as possible when
running against a production system. Sometimes my bash scripts can be a bit
overkill, but it’s better to be safe than sorry.&lt;/p&gt;

&lt;p&gt;It is therefore worth mentioning an update to &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible-lint&lt;/code&gt; shipped in 4.1.0
which has added the following rule:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;[306] Shells that use pipes should set the pipefail option&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;Without the pipefail option set, a shell command that implements a pipeline
can fail and still return 0. If any part of the pipeline other than the
terminal command fails, the whole pipeline will still return 0, which may
be considered a success by Ansible. Pipefail is available in the bash shell.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;– Source: &lt;a href=&quot;https://docs.ansible.com/ansible-lint/rules/default_rules.html&quot;&gt;https://docs.ansible.com/ansible-lint/rules/default_rules.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is actually a really good idea when automating shell tasks with the use of
pipes. In Ansible we should try and avoid using shell tasks where possible, but
it is sometimes unavoidable. So what does that actually mean in real life?&lt;/p&gt;

&lt;p&gt;Let’s consider a simple shell script that demonstrates the problem:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;This task should fail...&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: FAIL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: PASS&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;This task should pass...&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: FAIL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: PASS&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When we run it, we would expect the &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt; to cause a “FAIL”, however…&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ xmanning@dreadfort:/tmp ] $ ./pipefail_test.sh
This task should fail...
Task: PASS
This task should pass...
Task: PASS
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We get two “PASS” results! Why you ask? This is because whilst the &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;
command produces a return code of 1, the &lt;code class=&quot;highlighter-rouge&quot;&gt;echo&lt;/code&gt; after the pipe exits with a
return of 0.&lt;/p&gt;

&lt;p&gt;Ansible will see this as a successful shell task, and really it probably is not.&lt;/p&gt;

&lt;p&gt;So we use the bash builtin option &lt;code class=&quot;highlighter-rouge&quot;&gt;set -o pipefail&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; pipefail

&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;This task should fail...&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: FAIL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: PASS&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;This task should pass...&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: FAIL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Task: PASS&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now lets test again:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ xmanning@dreadfort:/tmp ] $ ./pipefail_test.sh
This task should fail...
Task: FAIL
This task should pass...
Task: PASS
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahhh, that’s better!&lt;/p&gt;

&lt;p&gt;So how do we put that into our Ansible? The annoying thing about some of these
lint rules is that your playbooks and roles will fail but there are no examples
of how best to fix them.&lt;/p&gt;

&lt;p&gt;Here is one of the ways of passing the test and making your shell tasks safer,
ensure that you add &lt;code class=&quot;highlighter-rouge&quot;&gt;set -o pipefail&lt;/code&gt; to the beginning of all shell tasks that
use pipes.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt;

&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Ensure a list of IPs is captured from /etc/hosts&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;no&quot;&gt;set -o pipefail &amp;amp;&amp;amp; \&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;grep -E &quot;^[0-9a-f]&quot; /etc/hosts | awk '{ print $1 }'&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;etc_hosts_iplist&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;executable&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/bin/bash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Take note that you need to specify the &lt;code class=&quot;highlighter-rouge&quot;&gt;executable: /bin/bash&lt;/code&gt; as Ansible will
likely use &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt; which does not support the &lt;code class=&quot;highlighter-rouge&quot;&gt;pipefail&lt;/code&gt; option and the task
will just fail.&lt;/p&gt;

&lt;p&gt;Having used &lt;code class=&quot;highlighter-rouge&quot;&gt;set -o pipefail &amp;amp;&amp;amp;&lt;/code&gt; at the beginning of the command, should there
be any problem with the &lt;code class=&quot;highlighter-rouge&quot;&gt;grep&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;awk&lt;/code&gt; command then the task will now show
as &lt;code class=&quot;highlighter-rouge&quot;&gt;Failed&lt;/code&gt; whereas previously the task would show as &lt;code class=&quot;highlighter-rouge&quot;&gt;Changed&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;And just like that you have explored safer shell scripting through Ansible.&lt;/p&gt;

&lt;p&gt;To read more about safer bash scripts, see
&lt;a href=&quot;https://vaneyckt.io/posts/safer_bash_scripts_with_set_euxo_pipefail/&quot;&gt;Tom Van Eyck’s article&lt;/a&gt;&lt;/p&gt;</content><author><name>Xan Manning</name></author><summary type="html">If you are like me you like to keep your scripting as safe as possible when running against a production system. Sometimes my bash scripts can be a bit overkill, but it’s better to be safe than sorry.</summary></entry><entry><title type="html">k3s - My first public Ansible Role</title><link href="http://localhost:4000/2019/03/09/k3s-my-first-public-ansible-role.html" rel="alternate" type="text/html" title="k3s - My first public Ansible Role" /><published>2019-03-09T21:02:42+00:00</published><updated>2019-03-09T21:02:42+00:00</updated><id>http://localhost:4000/2019/03/09/k3s-my-first-public-ansible-role</id><content type="html" xml:base="http://localhost:4000/2019/03/09/k3s-my-first-public-ansible-role.html">&lt;p&gt;Today marks the first time I have dared to release an Ansible role to Ansible
Galaxy. It’s not my first role and it certainly isn’t my best, unfortunately
my best role to date - a role for configuring Tinc - has (kind of) been donated
to the company I work for.&lt;/p&gt;

&lt;p&gt;So without further ado, please may I introduce…&lt;/p&gt;

&lt;h2 id=&quot;k3s&quot;&gt;k3s&lt;/h2&gt;

&lt;p&gt;For anyone who has been following the news recently, Rancher Labs released K3s -
also known as “Lightweight Kubernetes” and you can download it from
&lt;a href=&quot;https://k3s.io/&quot;&gt;https://k3s.io/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Even better, if you like to use Ansible, you can download and use my role to
build your own k3s cluster.&lt;/p&gt;

&lt;p&gt;Ansible Galaxy: &lt;a href=&quot;https://galaxy.ansible.com/xanmanning/k3s&quot;&gt;xanmanning.k3s&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Install: &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible-galaxy install xanmanning.k3s&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;It’s nothing special but it will probably get you started with k3s.&lt;/p&gt;

&lt;h3 id=&quot;disclaimer&quot;&gt;Disclaimer&lt;/h3&gt;

&lt;p&gt;I’m not going to have a lot of time to maintain the role, though I will try
my best. K3s is also not yet a v1.0 release and will likely change a lot so the
role will probably break in the near future.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Happy Hacking!&lt;/strong&gt;&lt;/p&gt;</content><author><name>Xan Manning</name></author><summary type="html">Today marks the first time I have dared to release an Ansible role to Ansible Galaxy. It’s not my first role and it certainly isn’t my best, unfortunately my best role to date - a role for configuring Tinc - has (kind of) been donated to the company I work for.</summary></entry><entry><title type="html">Snippet - List tenants of an SAP HANA MDC</title><link href="http://localhost:4000/2018/11/11/snippet-list-hana-mdc-tenants.html" rel="alternate" type="text/html" title="Snippet - List tenants of an SAP HANA MDC" /><published>2018-11-11T12:31:42+00:00</published><updated>2018-11-11T12:31:42+00:00</updated><id>http://localhost:4000/2018/11/11/snippet-list-hana-mdc-tenants</id><content type="html" xml:base="http://localhost:4000/2018/11/11/snippet-list-hana-mdc-tenants.html">&lt;p&gt;I thought I would share a snippet of code that I have found useful for
discovering all of the SIDs and Tenants running on an SAP HANA system running
with Multitenant Database Containers (MDC). If you are running HANA 2.0 this
is your default operating mode.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: I do not consider myself a HANA expert, whilst day-to-day I
work with HANA systems I focus more on OS level operations and automation.&lt;/p&gt;

&lt;p&gt;I have found occasion to find out all the instances running on a server, what
their SIDs are and any tenants that may exist. There’s an assumption that you
will find your HANA installation in &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/sap&lt;/code&gt; - it is here you will find
where instances are installed. You can print all the SIDs from this directory:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Find:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   maxdepth = 1, we only want to find stuff in this directory level.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   regextype = sed, we will use `sed` regular expressions to find our SIDs.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   regex = '.*/[A-Z0-9]\{3\}', a SID is a 3 uppercase alphanumeric characters.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   printf = '%f\n', just print the filename.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
find /usr/sap &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-maxdepth&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-regextype&lt;/span&gt; sed &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-regex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'.*/[A-Z0-9]\{3\}'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%f\n'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should expect output such as below:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;XMD
XMQ
XMP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So now we have a list of SIDs with our &lt;code class=&quot;highlighter-rouge&quot;&gt;find&lt;/code&gt; command, we can get the instance
number from each SID. Conveniently the instance number is found appended to the
end of a directory prefixed with “HDB”, eg: HDB00 for instance 00.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SIDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;find /usr/sap &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-maxdepth&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-regextype&lt;/span&gt; sed &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-regex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'.*/[A-Z0-9]\{3\}'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%f\n'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sid &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SIDS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; : &quot;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Find:&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#   Same as before, but this time we are using a different regex.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#   regex = '.*/HDB[0-9]\{2\}', find all directories prefixed with HDB&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       these should be suffixed with 2 numbers.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
    find &lt;span class=&quot;s2&quot;&gt;&quot;/usr/sap/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-maxdepth&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-regextype&lt;/span&gt; sed &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-regex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'.*/HDB[0-9]\{2\}'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%f\n'&lt;/span&gt; | sed &lt;span class=&quot;s1&quot;&gt;'s/HDB//'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Our expected output from the above should be a SID and it’s instance number:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;XMD : 10
XMQ : 05
XMP : 00
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we can look to see if it is an MDC and check how many tenants each instance
has. Conveniently there is a file that holds information about tenant
containers on the filesystem. You’ll likely find it here:
&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/sap/${sid}/SYS/global/hdb/mdc/databases.lst&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SIDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;find /usr/sap &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-maxdepth&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-regextype&lt;/span&gt; sed &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-regex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'.*/[A-Z0-9]\{3\}'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%f\n'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sid &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SIDS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; : &quot;&lt;/span&gt;

    find &lt;span class=&quot;s2&quot;&gt;&quot;/usr/sap/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-maxdepth&lt;/span&gt; 1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-regextype&lt;/span&gt; sed &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-regex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'.*/HDB[0-9]\{2\}'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;-printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%f\n'&lt;/span&gt; | sed &lt;span class=&quot;s1&quot;&gt;'s/HDB//'&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;DBLIST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/usr/sap/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/SYS/global/hdb/mdc/databases.lst&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DBLIST&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Grep 1:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   Remove all comments out of the file&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Grep 2:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   Look for a line beginning with a SID style string, it should end&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   with a 'yes' to signify it is active. Fields are delimited with&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   colons (:)&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Awk:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   Use the colon delimeter (:) to select and print the first field.&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Sed 1:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   Prefix each line with indentation and a hyphen&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Sed 2:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#   Suffix each tenant with the SID.&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DBLIST&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Ei&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'^[A-Z0-9]{3}:.*:yes$'&lt;/span&gt; | &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        awk &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;: &lt;span class=&quot;s1&quot;&gt;'{ print $1 }'&lt;/span&gt; | &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        sed &lt;span class=&quot;s1&quot;&gt;'s/^/  - /'&lt;/span&gt; | &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
        sed &lt;span class=&quot;s2&quot;&gt;&quot;s/&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sid&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi
done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So now we look for tenants for our database. The expected output should be
something like the below:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;XMD : 10
  - TD0@XMD
  - TD1@XMD
XMQ : 05
  - TD0@XMQ
XMP : 00
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It’s not the most elegant output but you can get some basic information this
way. You may also find it useful for gathering information on a system that
you do not have SYSTEM user access to.&lt;/p&gt;</content><author><name>Xan Manning</name></author><summary type="html">I thought I would share a snippet of code that I have found useful for discovering all of the SIDs and Tenants running on an SAP HANA system running with Multitenant Database Containers (MDC). If you are running HANA 2.0 this is your default operating mode.</summary></entry><entry><title type="html">Systemd-resolved, Flushing DNS in Ubuntu 18.04 (and other distributions).</title><link href="http://localhost:4000/2018/10/18/systemd-resolved-in-ubuntu.html" rel="alternate" type="text/html" title="Systemd-resolved, Flushing DNS in Ubuntu 18.04 (and other distributions)." /><published>2018-10-18T18:21:01+01:00</published><updated>2018-10-18T18:21:01+01:00</updated><id>http://localhost:4000/2018/10/18/systemd-resolved-in-ubuntu</id><content type="html" xml:base="http://localhost:4000/2018/10/18/systemd-resolved-in-ubuntu.html">&lt;p&gt;Today I’ve been playing with static DNS on my router, sadly Miktotik doesn’t
support “DNS Doctoring” and it doesn’t look like Ubiquiti Networks equipment
does either (as of 2018). It’s likely a feature I got spoilt with on a couple
of Cisco routers I had access to.&lt;/p&gt;

&lt;p&gt;Anyway, back to the point. Using Ubuntu 16.04 for a long time on my work laptop
and now CentOS 7 I have been used to working with &lt;code class=&quot;highlighter-rouge&quot;&gt;dnsmasq&lt;/code&gt; and how to clear
the cache.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ xmanning@pc-xmann-01: ~ ] $ grep -E &quot;^PRETTY_NAME&quot; /etc/os-release &amp;amp;&amp;amp; sudo ss -pant | grep -E &quot;^LISTEN&quot; | grep :53
PRETTY_NAME=&quot;CentOS Linux 7 (Core)&quot;
LISTEN     0      5      192.168.122.1:53                       *:*                   users:((&quot;dnsmasq&quot;,pid=2462,fd=6))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On Ubuntu 18.04, and other distributions of course, this has been replaced with
a systemd service called &lt;code class=&quot;highlighter-rouge&quot;&gt;systemd-resolved&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ xmanning@dreadfort:~ ] $ grep -E &quot;^PRETTY_NAME&quot; /etc/os-release &amp;amp;&amp;amp; sudo ss -pant | grep -E &quot;^LISTEN&quot; | grep :53
PRETTY_NAME=&quot;Ubuntu 18.04.1 LTS&quot;
LISTEN      0        128         127.0.0.53%lo:53               0.0.0.0:*        users:((&quot;systemd-resolve&quot;,pid=6977,fd=13))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, to flush! If you’re finding there’s a need to clear the DNS cache here’s
how you do it:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Method 1:&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo systemd-resolve --flush-caches&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Method 2:&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo systemctl restart systemd-resolved&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;sources&quot;&gt;Sources&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;man &lt;a href=&quot;http://man7.org/linux/man-pages/man1/systemd-resolve.1.html&quot;&gt;systemd-resolve(1)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Xan Manning</name></author><summary type="html">Today I’ve been playing with static DNS on my router, sadly Miktotik doesn’t support “DNS Doctoring” and it doesn’t look like Ubiquiti Networks equipment does either (as of 2018). It’s likely a feature I got spoilt with on a couple of Cisco routers I had access to.</summary></entry><entry><title type="html">Remembering HTTPS Authentication in git</title><link href="http://localhost:4000/2018/09/24/https-auth-in-git.html" rel="alternate" type="text/html" title="Remembering HTTPS Authentication in git" /><published>2018-09-24T20:37:48+01:00</published><updated>2018-09-24T20:37:48+01:00</updated><id>http://localhost:4000/2018/09/24/https-auth-in-git</id><content type="html" xml:base="http://localhost:4000/2018/09/24/https-auth-in-git.html">&lt;p&gt;Quick tip for anyone who is wanting git to remember their username/password
when issuing push/pulls to a git repository over HTTPS, run the following:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git config credential.helper store
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will remember your username and password by storing in a plaintext file
in &lt;code class=&quot;highlighter-rouge&quot;&gt;${HOME}/.git-credentials&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: Only do this if you know your home directory is secure from
other users!&lt;/p&gt;

&lt;h2 id=&quot;source&quot;&gt;Source&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;git: &lt;a href=&quot;https://git-scm.com/docs/git-credential-store&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;credential-store&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Xan Manning</name></author><summary type="html">Quick tip for anyone who is wanting git to remember their username/password when issuing push/pulls to a git repository over HTTPS, run the following:</summary></entry><entry><title type="html">Dropping the Hyphen!</title><link href="http://localhost:4000/2018/08/31/dropping-the-hyphen.html" rel="alternate" type="text/html" title="Dropping the Hyphen!" /><published>2018-08-31T19:12:55+01:00</published><updated>2018-08-31T19:12:55+01:00</updated><id>http://localhost:4000/2018/08/31/dropping-the-hyphen</id><content type="html" xml:base="http://localhost:4000/2018/08/31/dropping-the-hyphen.html">&lt;p&gt;You may think I’m mad, but I am going to drop the hyphen in my domain, so very
shortly you will see that instead of visiting
&lt;a href=&quot;https://xan-manning.co.uk&quot;&gt;https://xan-manning.co.uk&lt;/a&gt;, you will be visiting
&lt;a href=&quot;https://xanmanning.co.uk&quot;&gt;https://xanmanning.co.uk&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Why are you doing this, Xan?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Well, you have probably noticed that pretty much every other vanity domain on
the net is lacking a hyphen between firstname and surname; I’m just following
that convention.&lt;/p&gt;

&lt;p&gt;I’ll keep the ol’ xan-manning.co.uk domain, but it will redirect to
xanmanning.co.uk.&lt;/p&gt;

&lt;p&gt;Sorry folks.&lt;/p&gt;</content><author><name>Xan Manning</name></author><summary type="html">You may think I’m mad, but I am going to drop the hyphen in my domain, so very shortly you will see that instead of visiting https://xan-manning.co.uk, you will be visiting https://xanmanning.co.uk.</summary></entry><entry><title type="html">Code to Kubernetes in 15 Minutes</title><link href="http://localhost:4000/2018/08/19/code-to-kubernetes-in-15-minutes.html" rel="alternate" type="text/html" title="Code to Kubernetes in 15 Minutes" /><published>2018-08-19T12:28:48+01:00</published><updated>2018-08-19T12:28:48+01:00</updated><id>http://localhost:4000/2018/08/19/code-to-kubernetes-in-15-minutes</id><content type="html" xml:base="http://localhost:4000/2018/08/19/code-to-kubernetes-in-15-minutes.html">&lt;p&gt;As you may recall, &lt;a href=&quot;/2018/06/23/weekend-deployment.html&quot;&gt;a couple of on-call’s ago&lt;/a&gt;
I started crafting a Kubernetes cluster using Vagrant and Ansible. Well I have
decided to upload my code to GitHub!&lt;/p&gt;

&lt;h2 id=&quot;download&quot;&gt;Download&lt;/h2&gt;

&lt;p&gt;You can get the code from here:
&lt;a href=&quot;https://github.com/xanmanning/vagrant-kubernetes-cluster&quot;&gt;https://github.com/xanmanning/vagrant-kubernetes-cluster&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;heres-what-gets-deployed&quot;&gt;Here’s what gets deployed!&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;An NFS server for Persistent Volumes&lt;/li&gt;
  &lt;li&gt;3 Kubernetes Nodes (1 master, 2 workers). This can be increased in Vagrant.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018/08/cluster-diagram.png&quot; alt=&quot;K8s Cluster Diagram&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;demonstration&quot;&gt;Demonstration&lt;/h2&gt;

&lt;p&gt;In the below demo I go from sourcecode, to a 3 node cluster + storage in 15
minutes. I then deploy a MySQL Stateful Set which takes us up to 22 minutes.&lt;/p&gt;

&lt;p&gt;I’m always amazed how I can go from 650Kb of code to 4 virtual machines running
a test Kubernetes Cluster.&lt;/p&gt;

&lt;p&gt;It’s long and there’s a lot of pauses.&lt;/p&gt;

&lt;script src=&quot;https://asciinema.org/a/197075.js&quot; id=&quot;asciicast-197075&quot; async=&quot;&quot;&gt;&lt;/script&gt;</content><author><name>Xan Manning</name></author><summary type="html">As you may recall, a couple of on-call’s ago I started crafting a Kubernetes cluster using Vagrant and Ansible. Well I have decided to upload my code to GitHub!</summary></entry></feed>